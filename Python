import subprocess

# Step 1: Define paths and filenames
analysis_exe_path = "path_to_LoadRunner_Analysis_executable/AnalysisUI.exe"
result_file_path = "path_to_result_file.lrr"
output_summary_report_path = "output_summary_report.txt"
output_excel_path = "output_excel_file.xlsx"

# Step 2: Generate the summary report using LoadRunner Analysis CLI
subprocess.run([analysis_exe_path, "-Run", "AnalysisCmd", "-ResultPath", result_file_path, "-Output", output_summary_report_path])

# Step 3: Parse the generated summary report data (not shown here)

# Step 4: Write the parsed data to Excel (not shown here)

import pandas as pd

# Step 3: Parse the generated summary report data
def parse_summary_report(summary_report_path):
    parsed_data = {}
    with open(summary_report_path, "r") as file:
        for line in file:
            # Example parsing logic:
            # Assuming each line contains key-value pairs separated by ':'
            parts = line.strip().split(':')
            if len(parts) == 2:
                key = parts[0].strip()
                value = parts[1].strip()
                parsed_data[key] = value
    return parsed_data

# Call the function to parse the summary report
summary_report_data = parse_summary_report(output_summary_report_path)

# Step 4: Write the parsed data to Excel
df = pd.DataFrame(summary_report_data.items(), columns=['Key', 'Value'])
df.to_excel(output_excel_path, index=False)

print("Parsed data written to Excel successfully.")
